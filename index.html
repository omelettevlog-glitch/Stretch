<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>è‰åŸæ‹‰ä¼¸å¤§å†’é™© - ä¸“ä¸šç‰ˆ</title>
    <style>
        :root { --main-green: #4caf50; --sky-blue: #87CEEB; }
        body {
            font-family: 'Segoe UI', sans-serif;
            background: linear-gradient(to bottom, var(--sky-blue) 0%, #f1f8e9 50%, #81c784 100%);
            display: flex; flex-direction: column; align-items: center; justify-content: center;
            min-height: 100vh; margin: 0; padding: 20px;
        }
        .container {
            background: rgba(255, 255, 255, 0.92);
            border-radius: 25px; box-shadow: 0 15px 35px rgba(0,0,0,0.2);
            padding: 25px; width: 100%; max-width: 450px; text-align: center;
            border: 4px solid #fff;
        }
        .user-card {
            background: white; border-radius: 15px; padding: 12px; margin-bottom: 15px;
            border: 2px solid var(--main-green); font-size: 14px;
        }
        .level-tag { background: #ffeb3b; padding: 2px 8px; border-radius: 10px; font-weight: bold; }
        
        .timer { font-size: 80px; font-weight: bold; color: var(--main-green); margin: 10px 0; }
        .status-badge { font-size: 18px; font-weight: bold; color: #e67e22; margin-bottom: 5px; }
        .exercise-title { font-size: 26px; font-weight: bold; color: #1565c0; min-height: 35px; }

        .instructions { 
            text-align: left; background: #f9f9f9; padding: 15px; 
            border-radius: 12px; margin: 15px 0; min-height: 140px;
            border-left: 5px solid var(--main-green);
        }
        .instructions ul { padding-left: 20px; margin: 5px 0; }
        .instructions li { margin-bottom: 5px; color: #333; line-height: 1.4; }

        .next-preview { font-size: 14px; color: #666; font-style: italic; margin-top: 10px; }

        .controls button {
            background: var(--main-green); color: white; border: none;
            padding: 15px 40px; font-size: 20px; border-radius: 50px;
            cursor: pointer; box-shadow: 0 4px 0 #388e3c; transition: 0.2s; width: 80%;
        }
        .controls button:active { transform: translateY(4px); box-shadow: none; }
        
        .progress-container { width: 100%; margin-top: 20px; }
        .progress-bar { background: #ddd; height: 10px; border-radius: 5px; overflow: hidden; }
        .progress-fill { background: var(--main-green); height: 100%; width: 0%; transition: 0.5s; }
    </style>
</head>
<body>

<div class="container">
    <div class="user-card">
        <div><strong>å‹‡è€…:</strong> <span id="userNameDisplay">åŠ è½½ä¸­...</span> <span class="level-tag" id="levelName">æ‹‰ä¼¸èŒæ–°</span></div>
        <div style="margin-top:5px;">ğŸ”¥ è¿èƒœ: <span id="streakCount">0</span> å¤© | æ€»è®­ç»ƒ: <span id="totalWorkouts">0</span> æ¬¡</div>
    </div>

    <div class="status-badge" id="statusText">å‡†å¤‡å¥½äº†å—ï¼Ÿ</div>
    <div class="exercise-title" id="exerciseTitle">ç‚¹å‡»ä¸‹æ–¹å¼€å§‹</div>
    
    <div class="timer" id="timerDisplay">35</div>
    
    <div class="instructions" id="instructionsDiv">
        <div id="instructionContext" style="font-weight:bold; margin-bottom:5px; color:#2e7d32;">åŠ¨ä½œè¦é¢†ï¼š</div>
        <ul id="instructionsList">
            <li>å®Œæˆ 5 ä¸ªåŠ¨ä½œï¼Œæ¯é¡¹ 35 ç§’</li>
            <li>ä¼‘æ¯ 10 ç§’ï¼Œä¼šæœ‰ä¸‹ä¸€é¡¹é¢„å‘Š</li>
        </ul>
    </div>

    <div class="controls">
        <button id="startBtn" onclick="toggleTimer()">å¼€å¯å†’é™©</button>
    </div>

    <div class="progress-container">
        <div class="progress-bar"><div class="progress-fill" id="progressFill"></div></div>
        <div style="font-size:12px; color:#666; margin-top:5px;">è¿›åº¦: <span id="progressText">0/5</span></div>
    </div>
</div>

<audio id="beepSound" src="https://assets.mixkit.co/active_storage/sfx/2869/2869-preview.mp3" preload="auto"></audio>

<script>
    // --- æ•°æ®ä¸ç™»å½• ---
    let userName = localStorage.getItem('s_user') || prompt("è¯·è¾“å…¥ä½ çš„åå­—ï¼š") || "å‹‡è€…";
    localStorage.setItem('s_user', userName);
    let streak = parseInt(localStorage.getItem('s_streak')) || 0;
    let total = parseInt(localStorage.getItem('s_total')) || 0;
    
    document.getElementById('userNameDisplay').textContent = userName;
    document.getElementById('streakCount').textContent = streak;
    document.getElementById('totalWorkouts').textContent = total;
    updateLevel();

    function updateLevel() {
        let lv = "æ‹‰ä¼¸èŒæ–°";
        if(total > 5) lv = "æ‹‰ä¼¸è¿›é˜¶è€…";
        if(total > 15) lv = "ç­‹éª¨å¥‡æ‰";
        if(total > 30) lv = "è‰åŸæ‹‰ä¼¸å¤§å¸ˆ";
        document.getElementById('levelName').textContent = lv;
    }

    // --- åŠ¨ä½œæ•°æ® (å®Œå…¨åŒ¹é…ä½ çš„è¦æ±‚) ---
    const exercises = [
        {
            title: "1. å…¨èº«ä¼¸å±•",
            steps: ["åŒè„šæ‰“å¼€ä¸è‚©åŒå®½", "åŒæ‰‹é«˜ä¸¾å‘ä¸Šä¼¸ç›´", "å¤´å¾€ä¸Šæ‹‰ä¼¸ï¼Œæ„Ÿè§‰èƒŒéƒ¨è¢«æ‹‰é•¿"]
        },
        {
            title: "2. éª¨ç›†å‰å€¾ä¼¸å±•",
            steps: ["åŒè…¿ç«™å¥½", "åŒæ‰‹æ”¾åœ¨è…°ä¸¤ä¾§", "å‰å€¾éª¨ç›†ã€æŒºèƒ¸ã€çœ‹å‘å¤©èŠ±æ¿"]
        },
        {
            title: "3. è‡€éƒ¨æ‹‰ä¼¸",
            steps: ["ååœ¨åœ°ä¸Š", "ä¸€æ¡è…¿ä¼¸ç›´ï¼Œå¦ä¸€æ¡è…¿å¼¯æ›²ã€è„šæ”¾åœ¨å¤–ä¾§", "ä¸Šèº«å‘ä¼¸ç›´é‚£æ¡è…¿æ–¹å‘å¼¯"]
        },
        {
            title: "4. çŒ«ç‰›å¼ä¼¸å±•",
            steps: ["å››è‚¢ç€åœ°", "å¸æ°”èƒŒæ‹±ï¼ˆçŒ«ï¼‰", "å‘¼æ°”èƒŒä¸‹æ²‰ï¼ˆç‰›ï¼‰", "åå¤åŠ¨ä½œ"]
        },
        {
            title: "5. å¢™å£æŠ¬è…¿",
            steps: ["é¢å¯¹å¢™", "æŠ¬ä¸€æ¡è…¿åˆ°å¢™ä¸Š", "è½»è½»é åœ¨å¢™ä¸Šä¿æŒå¹³è¡¡"]
        }
    ];

    let currentIdx = 0, timeLeft = 35, isWorking = true, isRunning = false, timerInterval = null;
    const beep = document.getElementById('beepSound');

    function toggleTimer() {
        if (!isRunning) {
            beep.play(); beep.pause();
            timerInterval = setInterval(tick, 1000);
            document.getElementById('startBtn').textContent = "æš‚åœ";
        } else {
            clearInterval(timerInterval);
            document.getElementById('startBtn').textContent = "ç»§ç»­";
        }
        isRunning = !isRunning;
    }

    function tick() {
        timeLeft--;
        if (timeLeft < 0) {
            beep.play();
            if (isWorking) {
                isWorking = false;
                timeLeft = 10; // ä¼‘æ¯ 10 ç§’
                currentIdx++;
                if (currentIdx >= exercises.length) {
                    completeWorkout();
                    return;
                }
            } else {
                isWorking = true;
                timeLeft = 35; // åŠ¨ä½œ 35 ç§’
            }
        }
        updateUI();
    }

    function updateUI() {
        document.getElementById('timerDisplay').textContent = timeLeft;
        const list = document.getElementById('instructionsList');
        const context = document.getElementById('instructionContext');

        if (isWorking) {
            document.getElementById('statusText').textContent = "ğŸ”¥ æ­£åœ¨è¿›è¡Œ";
            document.getElementById('statusText').style.color = "#e67e22";
            document.getElementById('exerciseTitle').textContent = exercises[currentIdx].title;
            context.textContent = "å½“å‰åŠ¨ä½œè¦é¢†ï¼š";
            list.innerHTML = exercises[currentIdx].steps.map(s => `<li>${s}</li>`).join('');
        } else {
            document.getElementById('statusText').textContent = "â˜• ä¼‘æ¯æ—¶é—´";
            document.getElementById('statusText').style.color = "#2980b9";
            document.getElementById('exerciseTitle').textContent = "å‡†å¤‡ä¸‹ä¸€ä¸ªåŠ¨ä½œ";
            context.textContent = `å³å°†å¼€å§‹: ${exercises[currentIdx].title}`;
            list.innerHTML = exercises[currentIdx].steps.map(s => `<li style="color:#888;">${s}</li>`).join('');
        }

        let progress = (currentIdx / 5) * 100;
        document.getElementById('progressFill').style.width = progress + "%";
        document.getElementById('progressText').textContent = currentIdx + "/5";
    }

    function completeWorkout() {
        clearInterval(timerInterval);
        const today = new Date().toISOString().split('T')[0];
        if (localStorage.getItem('s_last_date') !== today) {
            streak++; total++;
            localStorage.setItem('s_streak', streak);
            localStorage.setItem('s_total', total);
            localStorage.setItem('s_last_date', today);
        }
        alert("ğŸ‰ æŒ‘æˆ˜æˆåŠŸï¼è¿èƒœè®°å½•å·²æ›´æ–°ï¼");
        location.reload();
    }
</script>
</body>
</html>
