<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>è‰åŸæ‹‰ä¼¸å¤§å†’é™©</title>
    <style>
        :root { --main-green: #4caf50; --sky-blue: #87CEEB; }
        body {
            font-family: 'Segoe UI', sans-serif;
            /* æ¨¡æ‹Ÿè‰åŸèƒŒæ™¯ï¼šå¤©ç©ºåˆ°è‰åœ°çš„æ¸å˜ */
            background: linear-gradient(to bottom, var(--sky-blue) 0%, #e8f5e9 50%, #81c784 100%);
            display: flex; flex-direction: column; align-items: center; justify-content: center;
            min-height: 100vh; margin: 0; padding: 20px;
        }
        .container {
            background: rgba(255, 255, 255, 0.9);
            border-radius: 25px; box-shadow: 0 15px 35px rgba(0,0,0,0.2);
            padding: 25px; width: 100%; max-width: 400px; text-align: center;
            border: 4px solid #fff;
        }
        .user-card {
            background: white; border-radius: 15px; padding: 15px; margin-bottom: 15px;
            border: 2px solid var(--main-green);
        }
        .level-tag { background: #ffeb3b; padding: 2px 8px; border-radius: 10px; font-size: 12px; font-weight: bold; }
        .quote-box { font-style: italic; color: #555; font-size: 13px; margin: 10px 0; min-height: 35px; }
        .timer { font-size: 80px; font-weight: bold; color: var(--main-green); text-shadow: 2px 2px 0px #fff; }
        .exercise-title { font-size: 26px; font-weight: bold; color: #2e7d32; }
        .controls button {
            background: var(--main-green); color: white; border: none;
            padding: 15px 35px; font-size: 18px; border-radius: 50px;
            cursor: pointer; box-shadow: 0 4px 0 #388e3c; transition: 0.2s;
        }
        .controls button:active { transform: translateY(4px); box-shadow: none; }
        .progress-bar { background: #ddd; height: 10px; border-radius: 5px; margin-top: 20px; overflow: hidden; }
        .progress-fill { background: var(--main-green); height: 100%; width: 0%; transition: 0.5s; }
    </style>
</head>
<body>

<div class="container" id="app">
    <div class="user-card">
        <div id="userNameDisplay" style="font-size: 18px; font-weight: bold;">æœ‹å‹ï¼Œå‡†å¤‡å¥½äº†å—ï¼Ÿ</div>
        <div>
            <span class="level-tag" id="levelName">æ‹‰ä¼¸èŒæ–°</span>
            ğŸ”¥ è¿èƒœ: <span id="streakCount">0</span> å¤©
        </div>
        <div class="quote-box" id="dailyQuote">"æ¯ä¸€æ¬¡æ‹‰ä¼¸ï¼Œéƒ½æ˜¯å¯¹èº«ä½“çš„æ¸©æŸ”è¡¨ç™½ã€‚"</div>
    </div>

    <div class="exercise-title" id="exerciseTitle">ç‚¹å‡»æŒ‰é’®å¼€å§‹</div>
    <div class="timer" id="timerDisplay">35</div>
    
    <div id="instructions" style="margin: 15px 0; color: #444;"></div>

    <div class="controls">
        <button id="startBtn" onclick="toggleTimer()">å¼€å¯å†’é™©</button>
    </div>

    <div class="progress-bar"><div class="progress-fill" id="progressFill"></div></div>
    <p style="font-size: 12px; color: #666; margin-top: 10px;">è¿›åº¦: <span id="progressText">0/5</span></p>
</div>

<audio id="beepSound" src="https://assets.mixkit.co/active_storage/sfx/2869/2869-preview.mp3" preload="auto"></audio>

<script>
    // --- æ•°æ®å­˜å‚¨ä¸é€»è¾‘ ---
    let userName = localStorage.getItem('s_user') || prompt("è¾“å…¥ä½ çš„å‹‡è€…åå­—ï¼š") || "åŒ¿åå‹‡è€…";
    localStorage.setItem('s_user', userName);
    let streak = parseInt(localStorage.getItem('s_streak')) || 0;
    let totalWorkouts = parseInt(localStorage.getItem('s_total')) || 0;
    
    const quotes = [
        "ä»Šå¤©çš„è‰æ€§æ ¼å¤–æ¸…æ–°ï¼Œæ­£é€‚åˆæ‹‰ä¼¸ï¼",
        "å¬ï¼Œé‚£æ˜¯éŸ§å¸¦åœ¨å˜å¿«ä¹çš„å£°éŸ³ã€‚",
        "å“ªæ€•åªæ˜¯ä¸€åˆ†é’Ÿï¼Œèº«ä½“ä¹Ÿä¼šæ„Ÿè°¢ä½ ã€‚",
        "è¿èƒœæ˜¯ä¸åŠ¨å£°è‰²çš„å¼ºå¤§ã€‚"
    ];

    document.getElementById('userNameDisplay').textContent = "å‹‡è€…: " + userName;
    document.getElementById('streakCount').textContent = streak;
    document.getElementById('dailyQuote').textContent = `"${quotes[Math.floor(Math.random()*quotes.length)]}"`;
    updateLevel();

    function updateLevel() {
        let level = "æ‹‰ä¼¸èŒæ–°";
        if (totalWorkouts > 5) level = "æ‹‰ä¼¸è¿›é˜¶è€…";
        if (totalWorkouts > 15) level = "ç­‹éª¨å¥‡æ‰";
        if (totalWorkouts > 30) level = "è‰åŸæ‹‰ä¼¸å¤§å¸ˆ";
        document.getElementById('levelName').textContent = level;
    }

    // --- è®¡æ—¶å™¨æ ¸å¿ƒ ---
    const exercises = [
        { t: "å…¨èº«ä¼¸å±•", d: "åŒæ‰‹ä¸¾é«˜ï¼Œè¯•å›¾è§¦ç¢°äº‘æœµ" },
        { t: "éª¨ç›†å‰å€¾", d: "æŒºèµ·èƒ¸è†›ï¼Œæ„Ÿå—è‰åŸçš„å¾®é£" },
        { t: "è‡€éƒ¨æ‹‰ä¼¸", d: "ç¨³ç¨³åä¸‹ï¼Œåƒå¤§æ ‘ä¸€æ ·æ‰æ ¹" },
        { t: "çŒ«ç‰›å¼", d: "åƒè‰åŸä¸Šçš„çŒ«ä¸€æ ·èˆ’å±•è„ŠæŸ±" },
        { t: "å¢™å£æŠ¬è…¿", d: "ä»°æœ›å¤©ç©ºï¼Œå½»åº•æ”¾æ¾åŒè…¿" }
    ];

    let currentIdx = 0, timeLeft = 35, isWorking = true, isRunning = false, timer = null;
    const beep = document.getElementById('beepSound');

    function toggleTimer() {
        if (!isRunning) {
            beep.play(); beep.pause();
            timer = setInterval(() => {
                timeLeft--;
                if (timeLeft < 0) {
                    beep.play();
                    if (isWorking) {
                        isWorking = false; timeLeft = 10; currentIdx++;
                    } else {
                        isWorking = true; timeLeft = 35;
                    }
                    if (currentIdx >= exercises.length) {
                        finishWorkout(); return;
                    }
                }
                refreshUI();
            }, 1000);
            document.getElementById('startBtn').textContent = "æš‚åœ";
        } else {
            clearInterval(timer);
            document.getElementById('startBtn').textContent = "ç»§ç»­";
        }
        isRunning = !isRunning;
    }

    function refreshUI() {
        document.getElementById('timerDisplay').textContent = timeLeft;
        if (isWorking && currentIdx < exercises.length) {
            document.getElementById('exerciseTitle').textContent = exercises[currentIdx].t;
            document.getElementById('instructions').textContent = exercises[currentIdx].d;
        } else {
            document.getElementById('exerciseTitle').textContent = "æ·±å‘¼å¸ï¼Œä¼‘æ¯ä¸­...";
        }
        let p = (currentIdx / 5) * 100;
        document.getElementById('progressFill').style.width = p + "%";
        document.getElementById('progressText').textContent = currentIdx + "/5";
    }

    function finishWorkout() {
        clearInterval(timer);
        const today = new Date().toISOString().split('T')[0];
        if (localStorage.getItem('s_last_date') !== today) {
            streak++;
            totalWorkouts++;
            localStorage.setItem('s_streak', streak);
            localStorage.setItem('s_total', totalWorkouts);
            localStorage.setItem('s_last_date', today);
        }
        alert("ğŸ‰ æŒ‘æˆ˜æˆåŠŸï¼ä½ åœ¨è‰åŸä¸Šåˆè¿ˆå‡ºäº†ä¸€å¤§æ­¥ï¼");
        location.reload();
    }
</script>
</body>
</html>
